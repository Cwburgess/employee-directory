(()=>{var a={};a.id=516,a.ids=[516],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},1708:a=>{"use strict";a.exports=require("node:process")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:a=>{"use strict";a.exports=require("node:buffer")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:a=>{"use strict";a.exports=require("assert")},14985:a=>{"use strict";a.exports=require("dns")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19185:a=>{"use strict";a.exports=require("dgram")},21820:a=>{"use strict";a.exports=require("os")},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31421:a=>{"use strict";a.exports=require("node:child_process")},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},37067:a=>{"use strict";a.exports=require("node:http")},38522:a=>{"use strict";a.exports=require("node:zlib")},41204:a=>{"use strict";a.exports=require("string_decoder")},44708:a=>{"use strict";a.exports=require("node:https")},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48161:a=>{"use strict";a.exports=require("node:os")},51455:a=>{"use strict";a.exports=require("node:fs/promises")},51620:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>I,patchFetch:()=>H,routeModule:()=>D,serverHooks:()=>G,workAsyncStorage:()=>E,workUnitAsyncStorage:()=>F});var d={};c.r(d),c.d(d,{GET:()=>C,dynamic:()=>z,revalidate:()=>A});var e=c(95736),f=c(9117),g=c(4044),h=c(39326),i=c(32324),j=c(261),k=c(54290),l=c(85328),m=c(38928),n=c(46595),o=c(3421),p=c(17679),q=c(41681),r=c(63446),s=c(86439),t=c(51356),u=c(10641),v=c(22161),w=c.n(v),x=c(89926);let y=(a,b)=>{let c=(0,x.u)(a).replace(/\D+/g,"");return c?/^general\s*counsel$/i.test((0,x.u)(b))?c.slice(-4):c.slice(-3):""},z="force-dynamic",A=0,B={user:process.env.DB_USER||"",password:process.env.DB_PASSWORD||"",server:process.env.DB_SERVER||"",database:process.env.DB_DATABASE||"",options:{encrypt:!0,trustServerCertificate:!1}};async function C(a){let b=null;try{let{searchParams:c}=new URL(a.url),d=c.get("search")?.trim()??"",e=d.toLowerCase(),f=(d??"").replace(/\D+/g,""),g=(b=await w().connect(B)).request();g.input("search",w().NVarChar(w().MAX),e),g.input("searchDigits",w().NVarChar(64),f);let h=(await g.query(`
      SELECT 
        ed.PREmp     AS ACHDEmpNo,
        ed.Name      AS name,
        ed.JobTitle  AS jobtitle,
        ed.WorkPhone AS workphone,
        ed.CellPhone AS number,
        ed.Email     AS email,
        ed.Unit      AS unit,
        ed.Crew      AS crew,
        ed.PRDept    AS prdept,
        ed.Location  AS location,
        ed.Reviewer  AS reportsto,
        ed.BirthDate AS birthDate,  -- <-- NEW COLUMN
        ed.HireDate AS hireDate  -- <-- NEW COLUMN
      FROM dbo.tEmployeesDetails ed
      WHERE ed.Name NOT LIKE '%test%' 
        AND ed.Name NOT LIKE '%wireless%'
        AND (
          @search = '' OR
          LOWER(ed.Name)     LIKE '%' + @search + '%' OR
          LOWER(ed.JobTitle) LIKE '%' + @search + '%' OR
          LOWER(ed.PRDept)   LIKE '%' + @search + '%' OR
          LOWER(ed.Email)    LIKE '%' + @search + '%' OR
          LOWER(ed.Unit)     LIKE '%' + @search + '%' OR
          LOWER(ed.Crew)     LIKE '%' + @search + '%' OR
          LOWER(ed.Location) LIKE '%' + @search + '%' OR
          (
            @searchDigits <> '' AND
            (
              REPLACE(REPLACE(REPLACE(REPLACE(ISNULL(ed.WorkPhone,''),'(',''),')',''),'-',''),' ','')
                LIKE '%' + @searchDigits + '%' OR
              REPLACE(REPLACE(REPLACE(REPLACE(ISNULL(ed.CellPhone,''),'(',''),')',''),'-',''),' ','')
                LIKE '%' + @searchDigits + '%'
            )
          )
        )
      ORDER BY ed.Unit, ed.Crew, ed.Name;
    `)).recordset,i=new Map,j=new Set(["jr","jr.","sr","sr.","ii","iii","iv","v"]),k=(a="")=>{let b=(a||"").trim().replace(/\s+/g," ");if(!b)return{first:"",last:""};if(b.includes(",")){let[a,c]=b.split(",",2).map(a=>a.trim());return{first:c||"",last:a||""}}let c=b.split(" "),d=c.at(-1)?.toLowerCase(),e=d&&j.has(d)?c.slice(0,-1):c;return 1===e.length?{first:"",last:e[0]}:{first:e.slice(0,-1).join(" "),last:e.at(-1)||""}};for(let a of h){let b=(0,x.u)(a.unit)||"Unassigned",c=(0,x.u)(a.crew)||"Unassigned",d=`${b}|||${c}`;i.has(d)||i.set(d,{unit:b,crew:c,members:[]});let{first:e,last:f}=k((0,x.u)(a.name)),g={ACHDEmpNo:String(a.ACHDEmpNo),name:(0,x.u)(a.name),firstName:e,lastName:f,jobtitle:(0,x.u)(a.jobtitle),workphone:a.workphone??null,extension:y(a.workphone,a.jobtitle)??null,number:(0,x.u)(a.number)||null,email:(0,x.u)(a.email)||null,unit:b,crew:c,prdept:(0,x.u)(a.prdept),location:(0,x.u)(a.location),reportsto:(0,x.u)(a.reportsto),birthDate:a.birthDate?new Date(a.birthDate).toISOString().split("T")[0]:null,hireDate:a.hireDate?new Date(a.hireDate).toISOString().split("T")[0]:null};i.get(d).members.push(g)}let l=Array.from(i.values());for(let a of(l.sort((a,b)=>a.unit.localeCompare(b.unit,void 0,{sensitivity:"base"})||a.crew.localeCompare(b.crew,void 0,{sensitivity:"base"})),l))a.members.sort((a,b)=>{let c=k(a.name).last.toLowerCase(),d=k(b.name).last.toLowerCase();if(c!==d)return c.localeCompare(d);let e=k(a.name).first.toLowerCase(),f=k(b.name).first.toLowerCase();return e.localeCompare(f)});return u.NextResponse.json(l,{headers:{"Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate",Pragma:"no-cache",Expires:"0","Surrogate-Control":"no-store"}})}catch(a){return console.error("Database error:",a),u.NextResponse.json({error:"Database connection failed"},{status:500})}finally{try{await b?.close()}catch{}}}let D=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/employee-directory/route",pathname:"/api/employee-directory",filename:"route",bundlePath:"app/api/employee-directory/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"C:\\Users\\Cburgess\\Documents\\Workspace\\employee-directory\\employee-directory\\src\\app\\api\\employee-directory\\route.ts",nextConfigOutput:"standalone",userland:d}),{workAsyncStorage:E,workUnitAsyncStorage:F,serverHooks:G}=D;function H(){return(0,g.patchFetch)({workAsyncStorage:E,workUnitAsyncStorage:F})}async function I(a,b,c){var d;let e="/api/employee-directory/route";"/index"===e&&(e="/");let g=await D.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:y,routerServerContext:z,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,resolvedPathname:C}=g,E=(0,j.normalizeAppPath)(e),F=!!(y.dynamicRoutes[E]||y.routes[C]);if(F&&!x){let a=!!y.routes[C],b=y.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let G=null;!F||D.isDev||x||(G="/index"===(G=C)?"/":G);let H=!0===D.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:y,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>D.onRequestError(a,b,d,z)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>D.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&A&&B&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await D.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:A})},z),b}},l=await D.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:y,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",A?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&F||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(b instanceof s.NoFallbackError||await D.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:A})}),F)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},57075:a=>{"use strict";a.exports=require("node:stream")},57975:a=>{"use strict";a.exports=require("node:util")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66136:a=>{"use strict";a.exports=require("timers")},73024:a=>{"use strict";a.exports=require("node:fs")},73136:a=>{"use strict";a.exports=require("node:url")},76760:a=>{"use strict";a.exports=require("node:path")},77598:a=>{"use strict";a.exports=require("node:crypto")},78335:()=>{},78474:a=>{"use strict";a.exports=require("node:events")},79428:a=>{"use strict";a.exports=require("buffer")},79551:a=>{"use strict";a.exports=require("url")},79646:a=>{"use strict";a.exports=require("child_process")},81115:a=>{"use strict";a.exports=require("constants")},81630:a=>{"use strict";a.exports=require("http")},83997:a=>{"use strict";a.exports=require("tty")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},89926:(a,b,c)=>{"use strict";c.d(b,{u:()=>d});let d=a=>{if(null==a)return"";let b=String(a).trim();return!b||/^(null|undefined|n\/a|na|none)$/i.test(b)?"":b}},91645:a=>{"use strict";a.exports=require("net")},94735:a=>{"use strict";a.exports=require("events")},96487:()=>{}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[996,692,161],()=>b(b.s=51620));module.exports=c})();